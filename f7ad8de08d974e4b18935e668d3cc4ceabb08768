{
  "comments": [
    {
      "key": {
        "uuid": "dc175149_add5f4f7",
        "filename": "verity/fec/Android.bp",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 1078064
      },
      "writtenOn": "2020-03-09T08:03:30Z",
      "side": 1,
      "message": "Excuse my ignorance, but does it not affect the verity/fec on all platforms, not just mac?",
      "range": {
        "startLine": 23,
        "startChar": 9,
        "endLine": 23,
        "endChar": 22
      },
      "revId": "f7ad8de08d974e4b18935e668d3cc4ceabb08768",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "891ed3ff_61046905",
        "filename": "verity/fec/Android.bp",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 1088085
      },
      "writtenOn": "2020-03-09T08:07:35Z",
      "side": 1,
      "message": "correct. Because the fec is not using libavb in practice, I believe it\u0027s fine. The fec binary is only used to generate verity \u0026 ecc data for verified boot 1.0. And we use the avbtool to do the work for VB2.0\n\nI also find the bp option \"exclude_static_libs\" isn\u0027t available for darwin. Otherwise I would go that way.",
      "parentUuid": "dc175149_add5f4f7",
      "range": {
        "startLine": 23,
        "startChar": 9,
        "endLine": 23,
        "endChar": 22
      },
      "revId": "f7ad8de08d974e4b18935e668d3cc4ceabb08768",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "831ba678_79c9f641",
        "filename": "verity/fec/Android.bp",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2020-03-09T15:57:21Z",
      "side": 1,
      "message": "+dwillemsen for\n\n  I also find the bp option \"exclude_static_libs\" isn\u0027t available for darwin.",
      "parentUuid": "891ed3ff_61046905",
      "range": {
        "startLine": 23,
        "startChar": 9,
        "endLine": 23,
        "endChar": 22
      },
      "revId": "f7ad8de08d974e4b18935e668d3cc4ceabb08768",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "80959ecf_dcdc7bf9",
        "filename": "verity/fec/Android.bp",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 1074628
      },
      "writtenOn": "2020-03-09T16:19:12Z",
      "side": 1,
      "message": "We\u0027ve generally only been adding the exclude_ properties as they come up. It\u0027s plausible to do something like:\n\n  target: {\n      linux: {\n          static_libs: [\"libfec\"],\n      },\n      darwin: {\n          static_libs: [\"libfec_no_avb\"],\n      },\n  },\n\n(or do the same thing in the libfec Android.bp file, so that `libfec` always works for your users, but only adds avb support on linux)",
      "parentUuid": "831ba678_79c9f641",
      "range": {
        "startLine": 23,
        "startChar": 9,
        "endLine": 23,
        "endChar": 22
      },
      "revId": "f7ad8de08d974e4b18935e668d3cc4ceabb08768",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a8b4e05b_14bd9e5c",
        "filename": "verity/fec/Android.bp",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 1088085
      },
      "writtenOn": "2020-03-09T18:07:54Z",
      "side": 1,
      "message": "Yeah, I was think about adding the logic in libfec\u0027s bp file. Probably need windows as well.\n  name: libfec\n  .....\n  target: {\n      linux: {\n          static_libs: [\"libavb\"],\n      },\n  },\n\nAnd then warp the logic with  \"if defined(__APPLE__)\" like ps1 does. I don\u0027t have a strong opinion on which option to make the fix.",
      "parentUuid": "80959ecf_dcdc7bf9",
      "range": {
        "startLine": 23,
        "startChar": 9,
        "endLine": 23,
        "endChar": 22
      },
      "revId": "f7ad8de08d974e4b18935e668d3cc4ceabb08768",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "58ae231f_d83c7a34",
        "filename": "verity/fec/Android.bp",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 1088085
      },
      "writtenOn": "2020-03-09T19:54:29Z",
      "side": 1,
      "message": "I was told we are only doing cross build for windows. So I specify the libavb in the build target and removed libfec_no_avb. Also I think a stub file might be cleaner than the preprocessor. Please re-test the change.",
      "parentUuid": "a8b4e05b_14bd9e5c",
      "range": {
        "startLine": 23,
        "startChar": 9,
        "endLine": 23,
        "endChar": 22
      },
      "revId": "f7ad8de08d974e4b18935e668d3cc4ceabb08768",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}