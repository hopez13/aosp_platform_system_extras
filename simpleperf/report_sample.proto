// The file format generated by report_sample.proto is as below:
// LittleEndian32(record_size_0)
// message Record(record_0) (having record_size_0 bytes)
// LittleEndian32(record_size_1)
// message Record(record_1) (having record_size_1 bytes)
// ...
// LittleEndian32(record_size_N)
// message Record(record_N) (having record_size_N bytes)
// LittleEndian32(0)

syntax = "proto2";
option optimize_for = LITE_RUNTIME;
package simpleperf_report_proto;
option java_package = "com.android.tools.profiler.proto";
option java_outer_classname = "SimpleperfReport";

message Sample {
  optional uint64 time = 1;

  message CallChainEntry {
    optional uint64 ip = 1;

    optional string symbol = 2 [deprecated=true];
    optional string file = 3 [deprecated=true];

    optional uint64 vaddr_in_file = 4;
    optional uint32 symbol_table_id = 5;
  }

  repeated CallChainEntry callchain = 2;
  optional int32 thread_id = 3;
}

message LostSituation {
  optional uint64 sample_count = 1;
  optional uint64 lost_count = 2;
}

message SymbolTable {
  optional uint32 id = 1;
  optional string file = 2;

  message Symbol {
    optional uint64 start = 1;
    optional uint64  end = 2;
    optional string name = 3;
  }

  repeated Symbol symbol = 3;
}

message Record {
  enum Type {
    UNKOWN = 0;
    SAMPLE = 1;
    LOST_SITUATION = 2;
    SYMBOL_TABLE = 3;
  }

  // Identifies which field is filled in.
  optional Type type = 1;

  // One of the following will be filled in.
  optional Sample sample = 2;
  optional LostSituation lost = 3;
  optional SymbolTable symbol_table = 4;
}